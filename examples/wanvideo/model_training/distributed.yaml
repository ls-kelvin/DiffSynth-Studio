debug: false

distributed_type: DEEPSPEED

deepspeed_config:
  gradient_accumulation_steps: 4  # 增加到4，减少通信频率
  gradient_clipping: 1.0
  offload_optimizer_device: none
  offload_param_device: none
  zero3_init_flag: false
  zero_stage: 2
  deepspeed_multinode_launcher: standard
  # 通信优化
  overlap_comm: true
  reduce_bucket_size: 2e8           # 减小 bucket 大小，更频繁但更小的通信
  allgather_bucket_size: 2e8        # AllGather bucket 大小
  stage3_prefetch_bucket_size: 2e8
  stage3_param_persistence_threshold: 1e6
  contiguous_gradients: true
  # 通信后端优化
  communication_data_type: bf16     # 使用 bf16 减少通信量

mixed_precision: bf16
downcast_bf16: 'no'
main_training_function: main
enable_cpu_affinity: false
rdzv_backend: static
same_network: true
use_cpu: false